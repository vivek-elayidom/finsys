<!DOCTYPE html>
<html lang="en">

    {% include "/assets.html" %}

    {% block body %}
        <script src="/static/assets/js/waves.min.js"></script>
        <!-- Begin page -->
        <div id="wrapper">

            <!-- Top Bar Start -->
    {% include "/topnav.html" %}
            <!-- Top Bar End -->

            <!-- ========== Left Sidebar Start ========== -->
            {% include "/sidebar.html" %}
            <!-- Left Sidebar End -->
            <link href="/static/assets/css/tooltip.css" rel="stylesheet" type="text/css">
            <link href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css">
            {% include "/datatableassets-css.html" %}
            

            <style>
            /* Ensure that the demo table scrolls */
                
 
        tr {
            cursor: pointer;
        }
            .thinBorder {
                /*border-radius: 3px;
                border-color: #ccc;
                */
                border:0px;
                border-bottom: 1px solid #ccc;
                margin-top: 2px;
                cursor: pointer;

            }
            .thinTextBox{
                border: 1px #ccc solid;
                cursor: pointer;

            }
            .validator{
                margin-top: 0px;
                margin-bottom: 1px;
                font-size: 10px;
            }
            .formTitle{
                margin-bottom: 0px;
                padding-bottom: 0px;

            }
            
            </style>
            <!-- ============================================================== -->
            <!-- Start right Content here -->
            <!-- ============================================================== -->
            <div class="content-page" style="overflow-y: auto;">
                <!-- Start content -->
                <div class="content">
                    <div class="container-fluid">
                        <div class="page-title-box">
                            <h4 class="mt-0 header-title">Bills till Date</h4>
                            <p class="sub-title">List of All Accounts of Vendors</p>
                            <div class="row">
                                <div class="card" style="width: 98%; margin-bottom: 5px;">
                                    <div class = "card-body" style="display: inline-block;height: 55px; vertical-align: middle; padding-top: 10px; " >
                                            <label>From</label>
                                            <input class="thinBorder" type="date" value="2011-08-19" id="example-date-input"  >
                                            <label style="margin-left: 10px;">To</label>
                                            <input class="thinBorder"  type="date" value="2011-08-19" id="example-date-input" >
                                            <label style="margin-left: 10px;">Head</label>
                                            <input class="thinBorder" type="search" value="" id="example-search-input">
                                            <label style="margin-left: 10px;">Vendor</label>
                                            <input class="thinBorder" type="search" value="" id="example-search-input">
                                            <button type="button" class="btn btn-outline-info waves-effect waves-light" style="margin-left: 10px;">Search</button>
                                    </div>
                                  </div>
                                  <div class="card" style="width: 50%;margin-top: 10px;">
                                    <div class="card-body">
                                        <table id="datatable" class="display" style="border-collapse: collapse; border-spacing: 0px; width: 100%; height: 400px;" role="grid" aria-describedby="datatable_info">
                                            <thead>
                                            <tr role="row">
                                            <th class="sorting_asc" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 135px;" aria-sort="ascending" aria-label="Name: activate to sort column descending">Name</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 208px;" aria-label="Position: activate to sort column ascending">ID</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 97px;" aria-label="Office: activate to sort column ascending">Amount</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 42px;" aria-label="Age: activate to sort column ascending">Currency</th>
                                            <th class="sorting" tabindex="0" aria-controls="datatable" rowspan="1" colspan="1" style="width: 91px;" aria-label="Start date: activate to sort column ascending">Start date</th>
                                            </thead>
                                            <tbody>
                                            </tbody>
                                        </table>
                                    </div>
                                  </div>
                                  <div class="card" style="width: 45%; margin-left: 30px;margin-top: 10px;">
                                    <div class="card-body">
                                        <div style="display: block;" id="controlBar" >

                                            <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                                <label class="btn btn-light active" id="newButton" onclick="changeState('new')">
                                                    <input type="radio" name="options" > New
                                                </label>
                                                <label class="btn btn-light "id="editButton" onclick="changeState('edit')">
                                                    <input type="radio" name="options" > Edit
                                                </label>
                                            </div>
                                            <!--
                                    title, meta,amount,headID,toEntityType,entityID,currency,t_date,r_date,status

                                                -->
                                            

                                        </div>
                                        <div id="newRecord" style="display: block;">
                                        <div style="display: block; margin-top: 15px;">
                                            <input class="thinBorder" style="display: inline-flex; width: 50px;font-size: 15px;" id="new_amount" type="text" value="" name="name"><input class="thinBorder" style="display: inline-flex; width: 50px; margin-left: 8px;font-size: 15px;" id="new_currency" type="text" value="" name="name">
                                        </div>
                                        <div style="display: block; margin-top: 10px;">
                                        <div class="row">
                                            <section>
                                                <div style="float:left;margin-left:20px;">
                                                  <label class="formTitle" style="display: block;" for="name">Title</label>
                                                  <p class="validator">Short Title for Expense</p>
                                                  <input class="thinBorder" style="display: block;" id="new_title" type="text" value="" name="name">
                                                    
                                                </div>
                                              
                                                <div style="float:left; margin-left: 10px;">
                                                  <label class="formTitle" style="display: block;" for="email">Category</label>
                                                  <p class="validator">Pick an Expense Head</p>
                                                  <input class="thinBorder" style="display: block;" id="new_category" type="text" value="" list="category">
                                                  <datalist id="category">
                                                    <option value="ABCD"></option>
                                                    <option value="EFGH"></option>
                                                    <option value="IJKL"></option>
                                                </datalist>
                                                </div>
                                                <br style="clear:both;"/>
                                            </section>
                                        </div>
                                        <div class="row" style="margin-top: 10px;">
                                            <section>
                                                <div style="float:left;margin-left:20px;">
                                                  <label class="formTitle" style="display: block;" for="name">Vendor</label>
                                                  <p class="validator">Select a Vendor</p>
                                                  <input class="thinBorder" style="display: block;" id="new_vendor" type="text" value="" name="name">
                                                </div>
                                               
                                                <div style="float:left; margin-left: 10px;">
                                                  <label class="formTitle" style="display: block;" for="email">Transaction Date</label>
                                                  <p class="validator">Give a Transaction Date</p>
                                                  <input class="thinBorder" style="display: block;" id="new_date" type="date" value="" name="email">
                                                </div>
                                                <br style="clear:both;" />
                                            </section>
                                        </div>
                                        <div class="row" style="margin-top: 10px;">
                                            <section>
                                                <div style="float:left;margin-left:20px;">
                                                  <label class="formTitle" style="display: block;" for="name">Remarks</label>
                                                  <p class="validator">A Short Remark in 100 Characters Max</p>
                                                  <textarea id="new_remarks" class="thinTextBox" style="width: 300px;height: 80px;resize: none;"></textarea>
                                                </div>
                                                <br style="clear:both;" />
                                            </section>
                                        </div>                                             
                                        </div>
                                        <div style="display: block; margin-top: 10px;">
                                            <form action="/expense/api/upload" class="dropzone">
                                                <div class="fallback">
                                                  <input id="new_file" name="file" class="thinTextBox" type="file" multiple />
                                                </div>
                                              </form>
                                        </div>
                                        </div>
                                        <div id="editRecord">
                                            <div style="display: block; margin-top: 10px;">
                                                <input class="thinBorder" style="display: inline-flex; width: 50px;font-size: 15px;font-weight: bold;" id="edit_amount" type="text" value="" name="name"><input class="thinBorder" style="display: inline-flex; width: 50px; margin-left: 8px;font-size: 15px;" id="edit_currency" type="text" value="" name="name">
                                            </div>
                                            <div style="display: block; margin-top: 10px;">
                                            <div class="row">
                                                <section>
                                                    <div style="float:left;margin-left:20px;">
                                                      <label class="formTitle" style="display: block;" for="name">Title</label>
                                                      <p class="validator">Short Title for Expense</p>
                                                      <input class="thinBorder" style="display: block;" id="edit_title" type="text" value="Edit Sample Expense" name="name">
                                                        
                                                    </div>
                                                  
                                                    <div style="float:left; margin-left: 10px;">
                                                      <label class="formTitle" style="display: block;" for="email">Category</label>
                                                      <p class="validator">Pick an Expense Head</p>
                                                      <input class="thinBorder" style="display: block;" id="edit_category" type="text" value="" list="category">
                                                      <datalist id="category">
                                                        <option value="ABCD"></option>
                                                        <option value="EFGH"></option>
                                                        <option value="IJKL"></option>
                                                    </datalist>
                                                    </div>
                                                    <br style="clear:both;"/>
                                                </section>
                                            </div>
                                            <div class="row" style="margin-top: 10px;">
                                                <section>
                                                    <div style="float:left;margin-left:20px;">
                                                      <label class="formTitle" style="display: block;" for="name">Vendor</label>
                                                      <p class="validator">Select a Vendor</p>
                                                      <input class="thinBorder" style="display: block;" id="edit_vendor" type="text" value="" name="name">
                                                    </div>
                                                   
                                                    <div style="float:left; margin-left: 10px;">
                                                      <label class="formTitle" style="display: block;" for="email">Transaction Date</label>
                                                      <p class="validator">Give a Transaction Date</p>
                                                      <input class="thinBorder" style="display: block;" id="edit_date" type="date" value="" name="email">
                                                    </div>
                                                    <br style="clear:both;" />
                                                </section>
                                            </div>
                                            <div class="row" style="margin-top: 10px;">
                                                <section>
                                                    <div style="float:left;margin-left:20px;">
                                                      <label class="formTitle" style="display: block;" for="name">Remarks</label>
                                                      <p class="validator">A Short Remark in 100 Characters Max</p>
                                                      <textarea id="edit_remarks" class="thinTextBox" style="width: 300px;height: 80px;resize: none;"></textarea>
                                                    </div>
                                                    <br style="clear:both;" />
                                                </section>
                                            </div>                                             
                                            </div>
                                            <div style="display: block; margin-top: 10px;">
                                                <form action="/expense/api/upload" class="dropzone">
                                                    <div class="fallback">
                                                      <input id="edit_file" name="file" class="thinTextBox" type="file" multiple />
                                                    </div>
                                                  </form>
                                            </div>
                                            </div>

                                    </div>
                                  </div>
                            
                            </div> <!-- end row data-toggle="modal" data-target="#confirmModal" -->

                        
 <!-- end row -->
                        </div>
                        <!-- end page-title -->

                        
                    </div>
                    <!-- container-fluid -->

                </div>
                <!-- content -->



            </div>
            <!-- ============================================================== -->
            <!-- End Right content here -->
            <!-- ============================================================== -->

        <!-- END wrapper -->


        
    {% endblock %}
    {% include "/jsassets.html" %}
    {% include "/datatableassets-js.html" %}

    <script>

        var state = 0;
        var recordID = 0; 
        (function() {
        


        })();

        function updateUI(data){

            
            document.getElementById("edit_title").value = data['title'];
            document.getElementById("edit_category").value = data['category'];
            document.getElementById("edit_vendor").value = data['vendorName'];
            document.getElementById("edit_date").value = data['date'];
            document.getElementById("edit_remarks").value = data['remarks'];
            document.getElementById("edit_amount").value = data['amount'];
            document.getElementById('edit_currency').value = data['currency'];
        
        }

        function getRecordDataFromAPI(id){
            $.get("/expense/api/getByID/"+id, function(data, status){
                console.log(data);
                updateUI(data);

            });

        }


        function loadEditViewDefault(data){

            d = data.data.reverse();


            var id = d[0][1];
            console.log("First Id is", id);
            
            getRecordDataFromAPI(id);

            

        };

        function loadEditViewByID(id){

            getRecordDataFromAPI(id);

        };

        function changeState(state){

            editRecord = document.getElementById("editRecord");
            newRecord = document.getElementById("newRecord");

            console.log("state is ",state);

            if(state=="new"){
                newRecord.style.display = "block";
                editRecord.style.display = "none";

            }
            if(state=="edit"){
                newRecord.style.display = "none";
                editRecord.style.display = "block";

            }

        };


    </script>

    <script>
     
    $(document).ready(function() {


       var newButton = $('#newButton');
       var editButton = $('#editButton');
       editButton.click();


        $.get("/expense/api/getAllExpenses", function(data, status){
            console.log(data);
            changeState('edit');
            loadEditViewDefault(data);
            
            var k = data.data;
            var l = k.reverse();

            $('#datatable').DataTable({
                paging:false,
                searching:true,
                scrollY:350,
                data: l,
                mark:true,
                //scroller: {
                //rowHeight: 10
                //},
                scrollCollapse:false,
                fixedColumns:{
                    heightMatch:'none'
                }
                });

            });

                    

        } );
        $("#createEmployee").click(function(){
                    $(location).attr('href', '/configure/employee/create')
                });

                $('#datatable').on('click', 'tbody tr', function() {
                    var table = $('#datatable').DataTable();
                    console.log('API row values : ', table.row(this).data());
                    var dataitem = table.row(this).data();
                    //console.log(dataitem[1],"is the item ID");
                    //var url = '/configure/employee/edit/'+dataitem[1]+'/'
                    //console.log(url)
                    //$(location).attr('href', url)
                    //dataitem[1]
                    loadEditViewByID(dataitem[1]);
                })
    
    </script>
</html>